<UserControl
	x:Class="NV.CT.NanoConsole.View.Control.SelfCheckSimpleControl"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:behaviors="clr-namespace:NV.CT.NanoConsole.Behaviors"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:gif="http://wpfanimatedgif.codeplex.com"
	xmlns:interactivity="http://schemas.microsoft.com/xaml/behaviors"
	xmlns:local="clr-namespace:NV.CT.NanoConsole.View.Control"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:res="clr-namespace:NV.CT.Language;assembly=NV.CT.Language"
	xmlns:controls="clr-namespace:NV.CT.UI.Controls.Controls;assembly=NV.CT.UI.Controls"
	Padding="0"
	d:DesignHeight="450"
	d:DesignWidth="800"
	Background="#16162B"
	MouseLeftButtonDown="SelfCheckSimpleControl_OnMouseLeftButtonDown"
	mc:Ignorable="d">
	<UserControl.Resources>
		<Style
			x:Key="AddEmergencyGlintButton"
			BasedOn="{StaticResource ToolbarButton}"
			TargetType="Button">
			<Setter Property="Width" Value="100" />
			<Setter Property="Height" Value="85" />
			<Style.Triggers>
				<Trigger Property="Button.IsMouseOver" Value="true">
					<Setter Property="Content">
						<Setter.Value>
							<Path
								VerticalAlignment="Center"
								Fill="White"
								Stretch="Fill"
								Style="{StaticResource Emergency}" />
						</Setter.Value>
					</Setter>
				</Trigger>
				<Trigger Property="Button.IsMouseOver" Value="false">
					<Setter Property="Content">
						<Setter.Value>
							<Path
								VerticalAlignment="Center"
								Fill="#FFA63F"
								Stretch="Fill"
								Style="{StaticResource Emergency}" />
						</Setter.Value>
					</Setter>
				</Trigger>
			</Style.Triggers>
		</Style>
	</UserControl.Resources>
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="150" />
			<RowDefinition Height="*" />
			<RowDefinition Height="200" />
			<RowDefinition Height="150" />
		</Grid.RowDefinitions>
		<Grid.ColumnDefinitions>
			<ColumnDefinition />
			<ColumnDefinition />
			<ColumnDefinition />
		</Grid.ColumnDefinitions>

		<!--  logo区域  -->
		<controls:LogoControl
			Grid.Row="0"
			Grid.Column="1"
			Width="350"
			HorizontalAlignment="Center"
			VerticalAlignment="Center"
			HorizontalContentAlignment="Center" />

		<!--  自检核心内容区域  -->
		<Grid
			Grid.Row="1"
			Grid.Column="1"
			Width="550"
			Height="550"
			Background="Transparent">
			<!--  修饰圆弧  -->
			<Ellipse
				Opacity="1"
				Stroke="black"
				StrokeDashCap="Round"
				StrokeThickness="4">
				<interactivity:Interaction.Behaviors>
					<behaviors:EllipseProgressBehavior
						EndAngle="90"
						Progress="100"
						StartAngle="-90" />
				</interactivity:Interaction.Behaviors>
			</Ellipse>

			<Grid
				Width="450"
				Height="450"
				ClipToBounds="True">
				<!--  闪电  -->
				<TextBlock
					Width="90"
					Height="84"
					Margin="0,60,0,0"
					VerticalAlignment="Top">
					<TextBlock.Background>
						<ImageBrush
							ImageSource="pack://application:,,,/NV.CT.UI.Controls;component/icons/thunder.png"
							Stretch="Fill" />
					</TextBlock.Background>
				</TextBlock>

				<!--  底部圆环  -->
				<Ellipse
					Opacity="1"
					Stroke="#05050F"
					StrokeDashCap="Round"
					StrokeThickness="15">
					<interactivity:Interaction.Behaviors>
						<behaviors:EllipseProgressBehavior
							EndAngle="125"
							Progress="100"
							StartAngle="-125" />
					</interactivity:Interaction.Behaviors>
				</Ellipse>
				<Ellipse
					StrokeDashCap="Round"
					StrokeThickness="15">
					<Ellipse.Stroke>
						<LinearGradientBrush StartPoint="0,0.5" EndPoint="1,0.5">
							<GradientStop Offset="0" Color="#02A4FF" />
							<GradientStop Offset="0.5" Color="#7D40FF" />
							<GradientStop Offset="1" Color="#7D40FF" />
						</LinearGradientBrush>
					</Ellipse.Stroke>

					<interactivity:Interaction.Behaviors>
						<behaviors:EllipseProgressBehavior
							EndAngle="125"
							Progress="{Binding Progress}"
							StartAngle="-125" />
					</interactivity:Interaction.Behaviors>
				</Ellipse>
				<Grid
					Margin="0,0,0,75"
					HorizontalAlignment="Center"
					VerticalAlignment="Bottom"
					Background="Transparent">
					<Grid.ColumnDefinitions>
						<ColumnDefinition />
						<ColumnDefinition />
					</Grid.ColumnDefinitions>
					<!--  进度值  -->
					<TextBlock
						Grid.Row="0"
						Grid.Column="0"
						VerticalAlignment="Center"
						FontSize="115"
						FontWeight="Bold"
						Foreground="#ffffff"
						Text="{Binding Progress, StringFormat=N0}" />
					<!--  百分标记符  -->
					<TextBlock
						Grid.Row="0"
						Grid.Column="1"
						Margin="15,28,0,0"
						HorizontalAlignment="Center"
						VerticalAlignment="Top"
						FontSize="26"
						Foreground="White"
						Text="%" />
				</Grid>

				<!--  左边百分比  -->
				<TextBlock
					Margin="35,356,0,0"
					HorizontalAlignment="Left"
					FontSize="18"
					Foreground="White"
					Opacity="0.3"
					Text="0%" />
				<!--  右边百分比  -->
				<TextBlock
					Margin="0,356,20,0"
					HorizontalAlignment="Right"
					FontSize="18"
					Foreground="White"
					Opacity="0.3"
					Text="100%" />

				<!--  自检中文本  -->
				<TextBlock
					Margin="0,0,0,80"
					HorizontalAlignment="Center"
					VerticalAlignment="Center"
					FontSize="18"
					Foreground="White"
					Opacity="0.4"
					Text="SELF CHECK" />

			</Grid>
		</Grid>

		<!--  自检内容-文字轮播区域  -->
		<Grid
			Grid.Row="2"
			Grid.Column="1">
			<DataGrid
				x:Name="dg"
				Margin="0,0,0,10"
				HorizontalAlignment="Stretch"
				VerticalContentAlignment="Center"
				AutoGenerateColumns="False"
				BorderThickness="0"
				CanUserSortColumns="False"
				ColumnHeaderHeight="40"
				GridLinesVisibility="Horizontal"
				HeadersVisibility="None"
				HorizontalGridLinesBrush="#18696969"
				HorizontalScrollBarVisibility="Disabled"
				IsReadOnly="True"
				ItemsSource="{Binding CheckItems}"
				RowHeight="40"
				ScrollViewer.CanContentScroll="False"
				SelectionUnit="Cell"
				VerticalScrollBarVisibility="Hidden">
				<DataGrid.Columns>

					<!--  检查进度状态标志图片，没啥意义，隐藏  -->
					<!--TODO:怀疑是这里的图片转换有问题 导致出现 ImageSourceConverter 异常, 观察-->
						<!--<DataGridTemplateColumn
						Width="45"
						Visibility="Visible">
						<DataGridTemplateColumn.CellTemplate>
							<DataTemplate>
								<Image
									x:Name="checkStateImg"
									Height="4"
									Margin="0,0,-30,6"
									HorizontalAlignment="Center"
									VerticalAlignment="Center"
									Source="pack://application:,,,/NV.CT.UI.Controls;component/Icons/NotScaned.png"
									Visibility="Visible" />

								<DataTemplate.Triggers>
									<DataTrigger
										Binding="{Binding CheckStatusString}"
										Value="Success">
										<Setter TargetName="checkStateImg" Property="Source" Value="pack://application:,,,/NV.CT.UI.Controls;component/Icons/Scaned.png" />
									</DataTrigger>
									<DataTrigger
										Binding="{Binding CheckStatusString}"
										Value="Error">
										<Setter TargetName="checkStateImg" Property="Source" Value="pack://application:,,,/NV.CT.UI.Controls;component/Icons/Scaned.png" />
									</DataTrigger>
									<DataTrigger
										Binding="{Binding CheckStatusString}"
										Value="InProgress">
										<Setter TargetName="checkStateImg" Property="Source" Value="pack://application:,,,/NV.CT.UI.Controls;component/Icons/StatusScaning.png" />
									</DataTrigger>
								</DataTemplate.Triggers>
							</DataTemplate>

						</DataGridTemplateColumn.CellTemplate>
					</DataGridTemplateColumn>-->

					<DataGridTextColumn
						Width="*"
						Binding="{Binding CheckName}" />

					<DataGridTemplateColumn
						Width="200"
						Header="Status">
						<DataGridTemplateColumn.CellTemplate>
							<DataTemplate>
								<Border VerticalAlignment="Center">
									<Grid VerticalAlignment="Center">

										<!--<Image
										x:Name="imgState"
										Height="20"
										HorizontalAlignment="Center"
										VerticalAlignment="Center"
										Source="{Binding CheckStatusString, Converter={StaticResource SelfCheckStateConverter}}"
										Visibility="Collapsed" />-->

										<Image
											x:Name="imgLoading"
											Height="25"
											HorizontalAlignment="Right"
											VerticalAlignment="Center"
											gif:ImageBehavior.AnimatedSource="pack://application:,,,/NV.CT.UI.Controls;component/Icons/hourglass.gif"
											Visibility="Collapsed" />

										<TextBlock
											x:Name="txtStatus"
											HorizontalAlignment="Right"
											Opacity="0.6"
											Visibility="Collapsed" />

										<!--for debug only-->
										<!--<TextBlock Text="{Binding CheckStatusString}"></TextBlock>-->
									</Grid>
								</Border>

								<DataTemplate.Triggers>
									<DataTrigger
										Binding="{Binding CheckStatusString}"
										Value="Success">
										<Setter TargetName="imgLoading" Property="Visibility" Value="Collapsed" />
										<Setter TargetName="txtStatus" Property="TextBlock.Visibility" Value="Visible" />
										<Setter TargetName="txtStatus" Property="TextBlock.Text" Value="Success" />
									</DataTrigger>
									<DataTrigger
										Binding="{Binding CheckStatusString}"
										Value="Error">
										<Setter TargetName="imgLoading" Property="Visibility" Value="Collapsed" />
										<Setter TargetName="txtStatus" Property="TextBlock.Visibility" Value="Visible" />
										<Setter TargetName="txtStatus" Property="TextBlock.Text" Value="Error" />
									</DataTrigger>
									<DataTrigger
										Binding="{Binding CheckStatusString}"
										Value="InProgress">
										<Setter TargetName="imgLoading" Property="Visibility" Value="Visible" />
										<Setter TargetName="txtStatus" Property="Visibility" Value="Collapsed" />
									</DataTrigger>
									<DataTrigger
										Binding="{Binding CheckStatusString}"
										Value="Unknown">
										<Setter TargetName="imgLoading" Property="Visibility" Value="Collapsed" />
										<Setter TargetName="txtStatus" Property="Visibility" Value="Visible" />
										<Setter TargetName="txtStatus" Property="TextBlock.Text" Value="Unknown" />
									</DataTrigger>
								</DataTemplate.Triggers>

							</DataTemplate>
						</DataGridTemplateColumn.CellTemplate>
					</DataGridTemplateColumn>

				</DataGrid.Columns>
			</DataGrid>
		</Grid>

		<!--  底部导航栏  -->
		<Grid
			Grid.Row="3"
			Grid.Column="2">

			<Grid
				Margin="0,0,100,0"
				HorizontalAlignment="Right"
				VerticalAlignment="Center">
				<StackPanel Orientation="Horizontal">
					<!--<Button Margin="0,0,50,0"
						Command="{Binding Commands[AddOrUpdateDeviceComponent]}"
						Content="update serial number" />

					<Button Margin="0,0,50,0"
					        Command="{Binding Commands[GetDeviceHistory]}"
					        Content="get device history" />-->

					<TextBlock
						x:Name="btnDetail"
						Margin="0,0,50,0"
						HorizontalAlignment="Center"
						VerticalAlignment="Center"
						Cursor="Hand"
						FontSize="24"
						MouseLeftButtonDown="BtnDetail_OnMouseLeftButtonDown"
						Opacity="0.3"
						Text="Detail" />

					<TextBlock
						x:Name="skipBtn"
						Margin="0,0,30,0"
						HorizontalAlignment="Right"
						VerticalAlignment="Center"
						Cursor="Hand"
						FontSize="24"
						FontWeight="Normal"
						MouseLeftButtonDown="SkipBtn_OnMouseLeftButtonDown"
						Opacity="0.3"
						Text="Skip" />

					<Button
						x:Name="btnEmergency"
						Command="{Binding Commands[EmergencyLoginCommand]}"
						Style="{StaticResource AddEmergencyGlintButton}"
						ToolTip="Emergency" />

				</StackPanel>
			</Grid>


			<!--<local:EmergencyControl />-->
		</Grid>
	</Grid>
</UserControl>
